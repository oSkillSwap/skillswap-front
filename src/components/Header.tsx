import { LogIn, Menu, X } from 'lucide-react';
import { useEffect, useState } from 'react';
import './Header.scss';
import { Link } from 'react-router';

function Header() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isMobile, setIsMobile] = useState(false);

  // Check if the screen is mobile size
  // and update the state accordingly
  useEffect(() => {
    const checkIfMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };

    // Initial check
    // to set the state based on the current screen size
    checkIfMobile();

    // Update the state on resize
    // to handle screen size changes
    window.addEventListener('resize', checkIfMobile);

    return () => {
      window.removeEventListener('resize', checkIfMobile);
    };
  }, []);

  const toggleMenu = () => {
    setIsMenuOpen(!isMenuOpen);
  };

  // Close the menu when a link is clicked on mobile
  const handleLinkClick = () => {
    if (isMobile && isMenuOpen) {
      toggleMenu();
    }
  };

  return (
    <header className="header container">
      <div className="header-wrapper">
        <Link className="header-logo" to="/" onClick={handleLinkClick}>
          <svg
            viewBox="0 0 361 78"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            role="img"
            aria-label="SkillSwap Logo"
          >
            <path
              d="M113.487 56.1844C111.296 56.1844 109.224 56.0159 107.27 55.679C105.316 55.3083 103.648 54.8029 102.266 54.1627V46.3286C103.782 47.0362 105.467 47.609 107.32 48.0471C109.174 48.4851 110.909 48.7041 112.526 48.7041C114.211 48.7041 115.475 48.5693 116.317 48.2998C117.193 47.9965 117.631 47.3395 117.631 46.3286C117.631 45.621 117.378 45.0651 116.873 44.6607C116.401 44.2564 115.643 43.8858 114.598 43.5488C113.588 43.2119 112.257 42.7907 110.606 42.2853C108.415 41.5777 106.68 40.8027 105.4 39.9603C104.119 39.1179 103.193 38.0902 102.62 36.8772C102.081 35.6642 101.811 34.1816 101.811 32.4295C101.811 29.2285 102.94 26.8025 105.198 25.1514C107.489 23.4667 110.875 22.6243 115.357 22.6243C117.142 22.6243 118.979 22.7759 120.866 23.0792C122.786 23.3824 124.336 23.7194 125.516 24.09V31.9746C123.932 31.3344 122.416 30.8795 120.967 30.61C119.518 30.3404 118.153 30.2057 116.873 30.2057C115.39 30.2057 114.127 30.3236 113.082 30.5594C112.038 30.7953 111.515 31.4018 111.515 32.379C111.515 33.2213 111.953 33.8447 112.83 34.249C113.739 34.6197 115.34 35.1083 117.631 35.7148C120.293 36.4224 122.315 37.2816 123.696 38.2924C125.111 39.3033 126.072 40.4826 126.577 41.8304C127.082 43.1445 127.335 44.6439 127.335 46.3286C127.335 49.2938 126.19 51.6861 123.898 53.5056C121.607 55.2915 118.136 56.1844 113.487 56.1844ZM130.857 55.679V23.1297H140.359V34.6028L150.215 23.1297H161.031L149.558 36.4729L161.84 55.679H151.731L143.695 42.538L140.359 46.2781V55.679H130.857ZM165.358 55.679V23.1297H174.86V55.679H165.358ZM179.425 55.679V23.1297H188.927V48.4009H203.584V55.679H179.425ZM206.128 55.679V23.1297H215.63V48.4009H230.287V55.679H206.128ZM243.646 56.1844C239.603 56.1844 236.335 55.679 233.841 54.6681V50.9785C235.256 51.5176 236.756 51.9388 238.339 52.2421C239.957 52.5116 241.608 52.6464 243.293 52.6464C246.19 52.6464 248.364 52.2589 249.812 51.4839C251.261 50.6753 251.986 49.2432 251.986 47.1879C251.986 45.9074 251.683 44.8966 251.076 44.1553C250.503 43.3803 249.543 42.7401 248.195 42.2347C246.847 41.6956 245.045 41.1565 242.787 40.6174C239.215 39.7413 236.705 38.6125 235.256 37.231C233.807 35.8158 233.083 33.9289 233.083 31.5703C233.083 28.8073 234.077 26.634 236.065 25.0503C238.053 23.433 241.086 22.6243 245.163 22.6243C247.049 22.6243 248.802 22.7591 250.419 23.0286C252.036 23.2982 253.283 23.5846 254.159 23.8879V27.5269C252.946 27.0889 251.632 26.7519 250.217 26.5161C248.802 26.2802 247.336 26.1623 245.82 26.1623C243.057 26.1623 240.934 26.5666 239.451 27.3753C237.969 28.184 237.227 29.5823 237.227 31.5703C237.227 32.6822 237.48 33.592 237.986 34.2996C238.525 34.9735 239.418 35.5631 240.664 36.0686C241.911 36.5403 243.646 37.0457 245.87 37.5848C248.532 38.225 250.604 39 252.087 39.9098C253.569 40.7858 254.614 41.8304 255.22 43.0434C255.827 44.2564 256.13 45.6379 256.13 47.1879C256.13 50.0519 255.086 52.2758 252.997 53.8594C250.908 55.4094 247.791 56.1844 243.646 56.1844ZM267.219 55.679L259.637 23.1297H263.731L269.847 49.9171L276.872 26.7182V23.1297H280.259L287.84 49.9171L294.057 23.1297H298.1L290.569 55.679H286.172L279.096 30.9132L271.666 55.679H267.219ZM298.383 55.679L310.766 23.1297H315.618L327.95 55.679H323.705L320.268 46.733H306.116L302.679 55.679H298.383ZM306.824 43.4477H319.51L313.142 26.7182L306.824 43.4477ZM333.994 55.679V23.1297H347.741C351.38 23.1297 354.059 24.1069 355.777 26.0612C357.496 28.0155 358.355 30.5426 358.355 33.6425C358.355 36.8098 357.378 39.3201 355.424 41.1733C353.503 42.9928 350.875 43.9026 347.539 43.9026H338.138V55.679H333.994ZM338.138 40.6679H346.882C349.308 40.6679 351.128 40.0445 352.341 38.7978C353.587 37.5174 354.211 35.799 354.211 33.6425C354.211 31.3513 353.621 29.5823 352.442 28.3356C351.296 27.0552 349.527 26.415 347.135 26.415H338.138V40.6679Z"
              fill="currentColor"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M43.6111 2.33143C46.1451 4.86547 46.1451 8.97395 43.6111 11.508L32.043 23.0761L72.6622 23.0761C76.2459 23.0761 79.151 25.9813 79.151 29.5649C79.151 33.1486 76.2459 36.0537 72.6622 36.0537L0.712281 36.0537L34.4346 2.33143C36.9686 -0.202601 41.0771 -0.202601 43.6111 2.33143Z"
              fill="currentColor"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M36.2522 75.6684C33.7181 73.1344 33.7181 69.0259 36.2522 66.4919L47.8203 54.9237L7.20107 54.9237C3.6174 54.9237 0.712267 52.0186 0.712268 48.4349C0.712268 44.8513 3.6174 41.9461 7.20107 41.9461L79.151 41.9462L45.4287 75.6684C42.8947 78.2025 38.7862 78.2025 36.2522 75.6684Z"
              fill="currentColor"
            />
          </svg>
        </Link>

        {isMobile && (
          <button
            className="hamburger-btn"
            onClick={toggleMenu}
            aria-label={isMenuOpen ? 'Fermer le menu' : 'Ouvrir le menu'}
            aria-expanded={isMenuOpen}
            type="button"
          >
            {isMenuOpen ? <X /> : <Menu />}
          </button>
        )}

        <nav
          className={`${isMobile ? 'mobile-nav' : ''} ${isMenuOpen ? 'open' : ''}`}
        >
          <ul className="header-nav">
            <li className="header-nav-element">
              <Link
                className="header-nav-element-link"
                to="/"
                onClick={handleLinkClick}
              >
                Accueil
              </Link>
            </li>
            <li className="header-nav-element">
              <Link
                className="header-nav-element-link"
                to="/explore"
                onClick={handleLinkClick}
              >
                Explorer
              </Link>
            </li>
            <li className="header-nav-element">
              <Link
                className="header-nav-element-link"
                to="/explore"
                onClick={handleLinkClick}
              >
                Annonces
              </Link>
            </li>
            <li className="header-nav-element">
              <a
                className="btn btn-reversed"
                href="/"
                onClick={handleLinkClick}
              >
                <LogIn />
                S'identifier
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
  );
}

export default Header;
